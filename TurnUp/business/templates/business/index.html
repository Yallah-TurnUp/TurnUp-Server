<!DOCTYPE html>
<!--[if IE 9 ]><html class="ie ie9" lang="en"><![endif]-->
<!--[if gt IE 9 | !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head>

    <link rel='stylesheet' href='../../static/css/blue.css'/>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=10,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel='stylesheet' href='../../static/css/bootstrap.min.css'>

</head>
<body>
<!--content Start -->
<div class="section-full align-c">
    <div id="siteBg" class="site-bg" style="background-image: url(../../static/img/bg/Galaxy_background.png);">
        <div id="star_animation" class="site-bg-animation layer" data-depth="0.30"></div>
        <canvas class="site-bg-canvas layer" data-depth="0.30"></canvas>
        <div id="star_back"></div>
        <div id="main_content" data-sr="top">
            <img id="cloudy" src="../../static/img/bg/float_cloud_desktop.png" />
            <img id="join_us" src="../../static/img/bg/invited.png"/>
            <img id="cloudy_S" src="../../static/img/bg/float_cloud_mobile.png" />
        </div>
        <img id="slide" class="rocket" src="../../static/img/item/rocket.png"/>
        <img id="rocket" class="rocket" src="../../static/img/item/rocket.png" style="display: none;"/>
        <div class="section" id="thumbs_cloud">
            <button id="thumbs_down" type="button" style="background: #ca3026;" class="button_splash" data-toggle="modal" data-target="#Fail" onclick="submitNo();">SORRY, I CANNOT COME</button>
            <button id="thumbs_up" type="button" class="button_splash shakee" data-toggle="modal" data-target="#ContactUs" onclick="submitSuccess();">I WOULD LOVE TO COME</button>
        </div>
        <img id="base-dark" src="../../static/img/bg/cloud_back.png" />
        <img id="base-dark_S" src="../../static/img/bg/cloud_back_S.png"/>

        <div class="modal fade" id="ContactUs" role="dialog" tabindex="-1">
            <div class="modal-dialog" role="document" style="overflow-y: initial !important">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h1 style="color: #59697b;">WELCOME</h1>
                    </div>

                    <div class="modal-body" style="overflow-y: auto; text-align:center; height: 45vh;">

                        <div id="load-spin" class="container" style="align-content: center;">
                            <div class="contact_message">Please wait while we process your information...</div>
                            <div class="loading-spinner"  style="width: 90%; margin-left: auto; margin-right: auto;">
                                <div class="progress progress-striped active">
                                    <div class="progress-bar" style="width: 100%;"></div>
                                </div>
                            </div>
                        </div>

                        <div id='thank_you'>
                            <img class="form_complete_img" src="../../static/img/item/green_tick.png"/>
                            <div class="contact_message">We've got your message and will contact you shortly, thank you!</div>
                            <div class="my_container" style="padding-bottom: 0;">
                                <h4 id="header_map">Click below to get directions:</h4>
                                <a href="https://goo.gl/maps/yscpKgPHqYG2" target="_blank">
                                    <img style="width: 90%; height: auto; cursor: pointer;-webkit-box-shadow: 0px 10px 50px 0px rgba(84,84,84,0.7);-moz-box-shadow: 0px 10px 50px 0px rgba(84,84,84,0.7);box-shadow: 0px 10px 50px 0px rgba(84,84,84,0.7);" src="../../static/img/item/biggy.PNG"/>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="height: 10vh; padding-bottom: 1.5vh;">
                        <a href="http://dariuspjm.wixsite.com/turnup">Like our invitation? Check us out~</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="Fail" role="dialog" tabindex="-1">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h1 style="color: #59697b;">THANK YOU</h1>
                    </div>

                    <div class="modal-body" style="text-align:center;">
                        <div id='rdd'>
                            <img class="form_complete_img" src="../../static/img/item/green_tick.png"/>
                            <div class="contact_message">We've got your message, thank you!</div>
                        </div>
                    </div>
                    <div class="modal-footer" style="height: 10vh;">
                        <a href="http://dariuspjm.wixsite.com/turnup">Like our invitation? Check us out~</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="../../static/js/jquery-1.9.1.js"></script>
<script src="../../static/js/bootstrap.min.js"></script>
<script src='../../static/js/vendor/plugin.js'></script>
<script src='../../static/js/variable.js'></script>
<script src='../../static/js/main.js'></script>

<script>
    $( window ).load(function() {
        $('#main_content').show();
        setTimeout(function (){$(document).trigger('is-loaded');
        }, 800);
    });

    $(document).ready(function () {
        setTimeout(function (){$("#rocket").fadeIn(800);
        }, 8000);
        setTimeout(function (){$("#thumbs_cloud").fadeIn(800);
        }, 8000);
        setTimeout(function (){$("#join_us").fadeIn(800);
        }, 7000);
    });

    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    var csrftoken = getCookie('csrftoken');

    function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }
    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });

    function sendRSVPInfo(attending, commonAvailabilityArray) {
        var rsvpData = {
            attending: attending,
            commonAvailability: commonAvailabilityArray,
            id: getUrlParameter('id'),
        };
        $.ajax({
            type: 'POST',
            url: '/rsvp',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: JSON.stringify(rsvpData),
        });
    }

    function submitNo () {
        setTimeout(function (){$('#Fail').hide();}, 4000);
        sendRSVPInfo(false);
    }

    function submitSuccess () {
        $('#load-spin').show();
        setTimeout(function (){$('#load-spin').hide();}, 2000);
        setTimeout(function (){$('#thank_you').show();}, 2000);
        sendRSVPInfo(true, ["1"]);
    }

    function postData (checkboxName) {
        var checkboxes = document.querySelectorAll('input[name="' + checkboxName + '"]:checked'), values = [];
        Array.prototype.forEach.call(checkboxes, function(el) {
            values.push(el.value);
        });
        console.log(values);
        sendRSVPInfo(true, values);
    }

    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }

</script>
<!--content End -->
</body>
</html>